rules_version = '2';
service firebase.storage {
  match /b/{bucket}/o {
    match /{allPaths=**} {
      allow read: if
        resource.name.startsWith('blog_images/') ||
        resource.name.startsWith('profile_images/');

      allow write: if request.auth != null
        && (
          // Blog images: any authenticated user
          (request.resource.name.startsWith('blog_images/')) ||
          // Profile images: only allow certain extensions and match user UID
          (
            request.resource.name.matches('profile_images/' + request.auth.uid + '\\.(jpg|jpeg|png|webp|gif)')
          )
        );
    }
  }
}
